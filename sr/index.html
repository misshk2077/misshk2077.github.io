<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>æœ€çˆ±å®å® - ç”Ÿæ—¥å¿«ä¹</title>
    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* --- 1. æ»šåŠ¨å¹³æ»‘åº¦ä¸æ€§èƒ½ä¼˜åŒ– --- */
        html { scroll-behavior: smooth; }
        body { -webkit-overflow-scrolling: touch; margin: 0; padding: 0; }
        .content-container { height: 100vh; overflow-y: auto; scroll-snap-type: y mandatory; }
        .fullscreen-section { scroll-snap-align: start; scroll-snap-stop: always; will-change: transform; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; }

        /* --- 2. ç”Ÿæ—¥ç¥ç¦å¡ç‰‡ --- */
        .wish-card { perspective: 1000px; }
        .wish-card-front { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%) !important; color: white !important; border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 4px 15px rgba(255, 154, 158, 0.4); }
        .wish-card-back { background: #fff5f6 !important; color: #d63384 !important; border: 1px solid #ffcad4; }

        /* --- 3. åœ¨ä¸€èµ·è®¡æ—¶å™¨æ ·å¼ --- */
        .love-timer-wrapper {
            background: rgba(255, 182, 193, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
            border: 1px dashed #ffb6c1;
            box-shadow: 0 4px 15px rgba(255, 182, 193, 0.1);
        }
        .timer-title { font-size: 0.95rem; color: #ff6b81; margin-bottom: 10px; display: block; letter-spacing: 1px; }
        .timer-display { font-family: 'Montserrat', sans-serif; font-weight: 700; color: #d63384; }
        .timer-unit-box { display: inline-block; margin: 0 3px; }
        .t-num { font-size: 1.4rem; }
        .t-label { font-size: 0.8rem; margin-left: 2px; color: #888; }

        /* --- 4. æ•°å­¦æŒ‘æˆ˜ä¸å¼¹çª—æ ·å¼ --- */
        .challenge-container { text-align: center; padding: 20px; z-index: 10; }
        .math-card { background: rgba(255, 255, 255, 0.9); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(255, 182, 193, 0.3); display: inline-block; border: 2px solid #ffcad4; }
        .question { font-size: 1.2rem; color: #d63384; margin-bottom: 25px; font-weight: bold; font-family: 'Montserrat', sans-serif; line-height: 2; }
        .answer-input { padding: 12px; border: 2px solid #ffcad4; border-radius: 10px; outline: none; width: 180px; text-align: center; font-size: 1.2rem; margin-bottom: 20px; display: block; margin-left: auto; margin-right: auto; }
        
        /* å¼¹çª—æ ·å¼ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.75); display: flex; justify-content: center; align-items: center; z-index: 9999; backdrop-filter: blur(5px); }
        .modal-content { background: white; padding: 40px; border-radius: 25px; text-align: center; box-shadow: 0 0 30px rgba(255, 107, 129, 0.5); animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); max-width: 80%; }
        .modal-text-line { font-size: 1.3rem; margin: 15px 0; color: #d63384; font-weight: bold; line-height: 1.6; }
        .close-modal-btn { margin-top: 25px; padding: 12px 35px; background: linear-gradient(to right, #ff9a9e, #ff6b81); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 10px rgba(255, 107, 129, 0.3); }
        .hidden { display: none !important; }

        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>
    <div class="starry-sky-container"><canvas id="starry-sky"></canvas></div>

    <div class="content-container">
        <div id="countdown-container" class="main-content">
            <h1 class="title">è·ç¦»æˆ‘æœ€çˆ±çš„äººç”Ÿæ—¥è¿˜æœ‰</h1>
            <div class="countdown-timer">
                <div class="time-unit"><span id="days" class="time-value">00</span><span class="time-label">å¤©</span></div>
                <div class="time-unit"><span id="hours" class="time-value">00</span><span class="time-label">æ—¶</span></div>
                <div class="time-unit"><span id="minutes" class="time-value">00</span><span class="time-label">åˆ†</span></div>
                <div class="time-unit"><span id="seconds" class="time-value">00</span><span class="time-label">ç§’</span></div>
            </div>
            <p class="love-message">åœ¨è¿™æ®µç­‰å¾…çš„æ—¶å…‰é‡Œï¼Œæˆ‘çš„çˆ±åªå¢ä¸å‡ â¤ï¸</p>
            <div class="birthday-reminder">
                <span class="reminder-icon">ğŸ</span>
                <p class="reminder-text">è¯·è®°å¾—åœ¨ç”Ÿæ—¥å½“å¤©æ‰“å¼€ï¼Œè¿™é‡Œæœ‰ä¸€ä»½ç‰¹åˆ«çš„æƒŠå–œåœ¨ç­‰ä½ ï¼</p>
            </div>
        </div>

        <div id="birthday-container" class="main-content hidden">
            <div class="fireworks-container"><canvas id="fireworks-canvas"></canvas></div>
            
            <section class="fullscreen-section" id="greeting-section">
                <h1 class="title birthday-title">ç”Ÿæ—¥å¿«ä¹ï¼Œæˆ‘æœ€çˆ±çš„å®å®ï¼</h1>
                <div id="gift-section" class="gift-section">
                    <div class="gift-box">
                        <div class="gift-lid"></div><div class="gift-box-body"></div><div class="gift-ribbon"></div>
                        <div class="gift-tag">ç‚¹å‡»æ‰“å¼€ä½ çš„ç¤¼ç‰©</div>
                    </div>
                </div>
                <div class="birthday-message hidden">
                    <p class="large-text">äº²çˆ±çš„å®å®ï¼Œç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼</p>
                    <p class="message-content">åœ¨è¿™ç‰¹åˆ«çš„æ—¥å­é‡Œï¼Œå°å®å®ç¥æ„¿å®å®èƒ½ä¸æ–­æˆé•¿è¿›æ­¥ï¼Œè¦ä¿æŒä¹è§‚ï¼ä»ç›¸è¯†åˆ°ç›¸çŸ¥ï¼Œè¿™æ˜¯æˆ‘ä¸ºä½ è¿‡çš„ç¬¬2ä¸ªç”Ÿæ—¥ã€‚å¸Œæœ›åœ¨æœªæ¥çš„æ—¥å­é‡Œï¼Œæˆ‘èƒ½ç»§ç»­é™ªä¼´åœ¨ä½ èº«è¾¹ã€‚</p>
                    <p class="message-signature">æ°¸è¿œçˆ±ä½ çš„é™ˆå°å®â¤ï¸</p>
                </div>
                <div class="scroll-indicator"></div>
            </section>

            <section class="fullscreen-section" id="love-tree-section">
                <div class="love-tree-container">
                    <h2 class="section-title">æˆ‘ä»¬çš„çˆ±å¿ƒæ ‘</h2>
                    <p class="tree-instruction">ç‚¹å‡»å±å¹•æ·»åŠ ä¸€é¢—çˆ±å¿ƒ</p>
                    <canvas id="love-tree" width="300" height="400"></canvas>
                </div>
                <div class="scroll-indicator"></div>
            </section>

            <section class="fullscreen-section" id="wishes-section">
                <div class="wishes-container">
                    <h2 class="section-title">ç”Ÿæ—¥ç¥ç¦</h2>
                    <div class="wishes-cards">
                        <div class="wish-card" onclick="this.classList.toggle('flipped')">
                            <div class="wish-card-front"><span>ç‚¹æˆ‘â¤</span></div>
                            <div class="wish-card-back"><p>ç¥æ„¿å®å®èº«ä½“å¥åº·ï¼Œå¿«ä¹æˆé•¿ï¼</p></div>
                        </div>
                        <div class="wish-card" onclick="this.classList.toggle('flipped')">
                            <div class="wish-card-front"><span>ç‚¹æˆ‘â¤</span></div>
                            <div class="wish-card-back"><p>å¸Œæœ›å®å®èƒ½å¤Ÿèµšæ›´å¤šé’±é’±ç»™å°å®å®èŠ±~å˜¿å˜¿ï¼</p></div>
                        </div>
                        <div class="wish-card" onclick="this.classList.toggle('flipped')">
                            <div class="wish-card-front"><span>ç‚¹æˆ‘â¤</span></div>
                            <div class="wish-card-back"><p>ç¥æ„¿å®å®èƒ½å¤Ÿå­¦ä¸šæœ‰æˆï¼</p></div>
                        </div>
                    </div>
                </div>
                <div class="wish-maker">
                    <div class="cake-container">
                        <div class="cake"><div class="candle"><div class="flame"></div></div></div>
                        <div id="wish-result" class="wish-result"></div>
                    </div>
                    <button id="make-wish-btn" class="wish-button">å¹èœ¡çƒ›è®¸æ„¿</button>
                </div>
                <div class="scroll-indicator"></div>
            </section>

            <section class="fullscreen-section" id="math-challenge-section">
                <div class="challenge-container">
                    <h2 class="section-title">æ™ºåŠ›æŒ‘æˆ˜</h2>
                    <p class="love-message" style="margin-bottom: 20px;">å®å®ï¼Œè§£å¼€è¿™é“å…³äºâ€œæ°¸æ’â€çš„å‡½æ•°é¢˜ï¼Œå°±èƒ½é¢†å–ç¤¼ç‰©ï¼š</p>
                    <div class="math-card">
                        <div class="question">
                            å·²çŸ¥å‡½æ•° \( f(x) = \log_{2}(x - 8) + 1314 \)<br>
                            è‹¥æ»¡è¶³ \( f(x) = 1323 \)<br>
                            æ±‚ \( x \) çš„å€¼ï¼Ÿ
                        </div>
                        <input type="number" id="math-answer" placeholder="è¾“å…¥ç­”æ¡ˆ..." class="answer-input">
                        <button onclick="checkMathAnswer()" class="wish-button">æäº¤ç­”æ¡ˆ</button>
                    </div>
                </div>
                <div class="scroll-indicator"></div>
            </section>

            <section class="fullscreen-section" id="love-letter-section">
                <div class="love-letter">
                    <h2 class="section-title">ç»™å®å®çš„ä¸€å°ä¿¡</h2>
                    <div class="letter-content">
                        <p>äº²çˆ±çš„å®å®ï¼Œ</p>
                        
                        <div class="love-timer-wrapper">
                            <span class="timer-title">ğŸ’• æˆ‘ä»¬å·²ç»ç›¸çˆ±äº† ğŸ’•</span>
                            <div class="timer-display">
                                <div class="timer-unit-box"><span id="t-days" class="t-num">0</span><span class="t-label">å¤©</span></div>
                                <div class="timer-unit-box"><span id="t-hours" class="t-num">00</span><span class="t-label">æ—¶</span></div>
                                <div class="timer-unit-box"><span id="t-minutes" class="t-num">00</span><span class="t-label">åˆ†</span></div>
                                <div class="timer-unit-box"><span id="t-seconds" class="t-num">00</span><span class="t-label">ç§’</span></div>
                            </div>
                        </div>

                        <p>æ—¶å…‰å¦‚æ¢­ï¼Œè½¬çœ¼é—´æˆ‘ä»¬å·²ç›¸ä¼´èµ°è¿‡äº†è®¸å¤šæ—¥å­ã€‚åœ¨ä½ çš„ç”Ÿæ—¥è¿™å¤©ï¼Œæƒ³å‘Šè¯‰ä½ ï¼Œä½ æ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€ç¾å¥½çš„ç¤¼ç‰©ã€‚</p>
                        <p>ä½†åœ¨æˆ‘ä»¬è®¤è¯†çš„æ—¶é—´é‡Œï¼Œæˆ‘è§è¯äº†ä½ ä»åˆšå¼€å§‹çš„ç¾æ¶©åˆ°ä¸æ­£ç»ï¼Œå˜¿å˜¿å˜¿ã€‚ä»Šåçš„è·¯è¿˜å¾ˆé•¿ï¼Œç¥æ„¿æˆ‘ä»¬å¹¸ç¦ç¾æ»¡ã€‚</p>
                        <p>ç”Ÿæ—¥å¿«ä¹ï¼Œæˆ‘æœ€çˆ±çš„å®å®ï¼</p>
                        <p class="signature">çˆ±ä½ çš„å°å®å®</p>
                    </div>
                </div>
            </section>
            
            <div class="floating-hearts"></div>
        </div>
    </div>

    <div id="gift-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-text-line">ğŸ æ­å–œå®å®è§£å¼€çˆ±çš„æ–¹ç¨‹å¼ï¼</div>
            <div class="modal-text-line">æ­£ç¡®ç­”æ¡ˆæ­£æ˜¯ 520</div>
            <div class="modal-text-line">è¿™æ˜¯å±äºå®å®çš„ä¸“å±ç¤¼ç‰©ï¼š</div>
            <div class="modal-text-line">ä¸€ç”Ÿä¸€ä¸–çš„é™ªä¼´ä¸çˆ± â¤ï¸</div>
            <button onclick="closeModal()" class="close-modal-btn">æ”¶ä¸‹ç¤¼ç‰©</button>
        </div>
    </div>

    <div class="music-player">
        <button id="music-toggle" class="music-btn"><span class="music-icon">â™ª</span></button>
        <audio id="bgm" loop><source src="assets/audio/birthday-music.mp3" type="audio/mpeg"></audio>
    </div>

    <script src="js/script.js"></script>
    <script>
        // æ•°å­¦æ ¡éªŒé€»è¾‘
        function checkMathAnswer() {
            const answer = document.getElementById('math-answer').value;
            if (answer == "520") { 
                document.getElementById('gift-modal').classList.remove('hidden');
            } else {
                alert("å“å‘€ï¼Œç®—é”™å•¦ï¼æç¤ºï¼šå®é™…ä¸Šæ˜¯æŒ‡æ•°è¿ç®— å†ç®—ç®—çœ‹å®å®~ ğŸ˜˜");
            }
        }

        function closeModal() {
            document.getElementById('gift-modal').classList.add('hidden');
            document.getElementById('love-letter-section').scrollIntoView({ behavior: 'smooth' });
        }

        // åœ¨ä¸€èµ·è®¡æ—¶å™¨é€»è¾‘
        (function() {
            const startDate = new Date(2024, 11, 6, 0, 0, 0); 
            function updateTogetherTime() {
                const now = new Date();
                const diff = now - startDate;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const minutes = Math.floor((diff / (1000 * 60)) % 60);
                const seconds = Math.floor((diff / 1000) % 60);
                const dElem = document.getElementById('t-days');
                const hElem = document.getElementById('t-hours');
                const mElem = document.getElementById('t-minutes');
                const sElem = document.getElementById('t-seconds');
                if (dElem) {
                    dElem.innerText = days;
                    hElem.innerText = hours.toString().padStart(2, '0');
                    mElem.innerText = minutes.toString().padStart(2, '0');
                    sElem.innerText = seconds.toString().padStart(2, '0');
                }
            }
            setInterval(updateTogetherTime, 1000);
            updateTogetherTime();
        })();
    </script>
</body>
</html>